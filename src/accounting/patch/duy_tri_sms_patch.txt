# Add the following entries to the special_account_mappings dictionary in IntegratedBankProcessor.__init__
        "DUY TRI SMS": "6427",  # SMS maintenance fee
        "PHI DUY TRI SMS": "6427",  # Alternative for SMS maintenance fee
        "BSMS": "6427",  # BIDV SMS service fee

# Add the following code block to the process_transaction method, in the section where other special patterns are handled
# It should be added where other pattern-specific business logic is implemented, after checking for other patterns like
# "Thanh toan lai", "Sang Tam", "ONL KDV PO", etc.

            # NEW BUSINESS LOGIC: Special handling for "DUY TRI SMS" transactions
            elif "DUY TRI SMS" in transaction.description.upper():
                bank_name = self.current_bank_name
                if bank_name:
                    # Get full bank info from current_bank_info
                    bank_address = self.current_bank_info.get("address", "")
                    bank_code = self.current_bank_info.get("code", "")

                    # Set counterparty code to bank code from _banks.json
                    if bank_code:
                        counterparty_code = str(bank_code)  # Make sure it's a string
                        self.logger.info(f"Setting counterparty code to bank code: {counterparty_code}")
                    else:
                        counterparty_code = "BANK-" + bank_name if bank_name else counterparty_code

                    description = "Phí Duy trì BSMS"
                    
                    # Override counterparty with bank info
                    counterparty_name = self.current_bank_info.get("name", bank_name) or counterparty_name
                    address = bank_address or address

                    self.logger.info(
                        f"Applied enhanced 'DUY TRI SMS' logic with bank info: {description}\n"
                        f"Counterparty Code: {counterparty_code}, Counterparty Name: {counterparty_name}"
                    )
                else:
                    # Fallback to standard description if no bank info
                    description = "Phí Duy trì BSMS"
                    self.logger.info(f"Applied standard 'DUY TRI SMS' logic (no bank info): {description}")

                # Also set the account determination as if this was a special pattern with fixed accounts
                if rule.document_type == "BN":  # Payment/Debit transaction - this is the typical case for SMS fees
                    debit_account = self.special_account_mappings.get("DUY TRI SMS", "6427")
                    credit_account = self.default_bank_account
                else:  # BC - Receipt/Credit transaction - unlikely for SMS fees, but included for completeness
                    debit_account = self.default_bank_account
                    credit_account = self.special_account_mappings.get("DUY TRI SMS", "6427")
